
{% extends 'master.html' %}
{% block siteTitle %}Laptop Return{% endblock %}
{% load permissions %}
{% load sales_permissions %}
{% load static from staticfiles %}
{% load process_tags %}
{% load rest_framework %}


{% block content  %}
<style type="text/css">

.table-condensed>thead>tr>th, .table-condensed>tbody>tr>th, .table-condensed>tfoot>tr>th, .table-condensed>thead>tr>td, .table-condensed>tbody>tr>td, .table-condensed>tfoot>tr>td {
   padding: 5px 8px;
}
.reimburse-action-button{width: 30px;border-radius: 25px;}

</style>

<link href="/static/plugins/dataTables/css/dataTables.bootstrap.css" rel="stylesheet" type="text/css">
<link href="/static/bootstrap3_datetime/css/bootstrap-datetimepicker.min.css" type="text/css" media="all" rel="stylesheet" />
<script type="text/javascript" src="/static/bootstrap3_datetime/js/moment.min.js"></script>
<script type="text/javascript" src="/static/bootstrap3_datetime/js/bootstrap-datetimepicker.min.js"></script>

     <div class="panel pb-15">
                  <div class="panel-heading vd_bg-grey clearfix">
                    <h2 class="panel-title pull-left" style="font-size: 15px;line-height: 30px">Basic List Group</h2>
                    <select class="form-control input-sm pull-right hidden" style="width: auto">
                      <option>2017</option>
                      <option>2016</option>
                      <option>2015</option>
                    </select>
                  </div>

    <div class="panel-body">

                    <ul class="nav nav-tabs">
                      <li class="active"><a href="#tab1" data-toggle="tab">User</a></li>
                    {% if request.user|has_group:'LaptopAdmin' %}
                      <li><a href="#tab2" data-toggle="tab">Admin</a></li>
                    {% endif %}
                    </ul>
                    <br/>
                    <div class="tab-content mgbt-xs-20">
                      <div class="tab-pane active" id="tab1">
                        <table class="table table-striped" id="data-tables">
                      <thead style="color: #fff;background: #444">
                        <tr>
                          <th>SL.No</th>
                          <th>Username</th>
                          <th>From Date</th>
                          <th>To Date</th>
                          <th>Process Status</th>
                          <th>Laptop</th>
                          <th>Reason</th>
                          <th>Laptop return</th>
                        </tr>
                      </thead>
                      <tbody>
                      {% for element in queryset %}
                      {% if element.user == request.user %}
                      <tr id="data">
                          <td>{{forloop.counter}}</td>
                          <td>{{element.user}}</td>
                          <td>{{element.from_date}}</td>
                          <td>{{element.to_date}}</td>
                          <td>{{element.process_status}}</td>
                          <td>{{element.laptop}}</td>
                          <td>{{element.reason}}</td>
                          <td><a type="button" id='return'
                                 class="btn btn-sm vd_bg-green vd_white pull-right return"
                                 idval = "{{element.id}}" value="Return">Return</a></td>
                        </tr>
                      {% endif %}
                      {% endfor %}
                      </tbody>

                    </table>

                      </div><!-- ./tab -->
                      <div class="tab-pane" id="tab2">

                        <table class="table table-striped" id="data-tables">
                      <thead style="color: #fff;background: #444">
                        <tr>
                          <th>SL.No</th>
                          <th>Username</th>
                          <th>From Date</th>
                          <th>To Date</th>
                          <th>Process Status</th>
                          <th>Laptop</th>
                          <th>Reason</th>
                          <th>Laptop return</th>
                        </tr>
                      </thead>
                      <tbody>

                      {% for element in queryset_admin %}
                        <tr>
                          <td>{{forloop.counter}}</td>
                          <td>{{element.user}}</td>
                          <td>{{element.from_date}}</td>
                          <td>{{element.to_date}}</td>
                          <td>{{element.process_status}}</td>
                          <td>{{element.laptop}}</td>
                          <td>{{element.reason}}</td>
                          <td><input type="button" id='approve' {% if element.process_status == "Completed" %} disabled {% endif %} class="btn btn-sm vd_bg-green vd_white pull-right approve" idval = "{{element.id}}" value="Approve"></td>
                        </tr>
                      {% endfor %}
                      </tbody>

                    </table>

                      </div><!-- ./tab -->

                      </div><!-- ./tab -->
                    </div>




</div>



<div class="modal fade" id="modal-container-Detail" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
                <div class="modal-dialog modal-lg">
                    <div class="modal-content">
                        <div class="modal-header vd_bg-blue vd_white">

                            <button  type="button" class="close" data-dismiss="modal" aria-hidden="true">
								x
							</button>

                            <h4 class="modal-title" id="myModalLabel">
								DETAIL
							</h4>
                        </div>
                        <div class="modal-body min-height-400" id="modal_body_detail">
                          <img src="/static/images/ajax-loader.gif">
                        </div>
                    <div class="modal-footer background-login">
                          <button type="button" class="btn vd_btn vd_bg-grey" data-dismiss="modal">Close</button>
                        </div>
                    </div><!-- ./modal-footer -->

                </div>

            </div>

<script type="text/javascript" src="/static/plugins/dataTables/jquery.dataTables.min.js"></script>
<script type="text/javascript" src="/static/js/dataTables.bootstrap.js"></script>

<script type="text/javascript">

 $('.return').click(function(){

    id = $(this).attr('idval');
    $.ajax({
    type: "GET",
    url : '/laptop/return/',
    data : {'id':id},
    success : function(data){
           swal({   title: "Return request raised successfully",
                    text: "",
                    type: "success",
                    confirmButtonText: "OK",
                    closeOnConfirm: true,
                    },
                    function(isConfirm) {
                    if (isConfirm) {
                        window.location=window.location
                    }

               });
    }
    });
    });

    $('.approve').click(function(){

    id = $(this).attr('idval');
    $.ajax({
    type: "GET",
    url : '/laptop/return/',
    data : {'approve_id':id},
    success : function(data){

           swal({   title: "Return approved successfully",
                    text: "",
                    type: "success",
                    confirmButtonText: "OK",
                    closeOnConfirm: true,
                    closeOnCancel: true
                    },
                    function(isConfirm) {
                    if (isConfirm) {
                        window.location=window.location
                    }
               });

    }
    });
    });


</script>
{% endblock %}